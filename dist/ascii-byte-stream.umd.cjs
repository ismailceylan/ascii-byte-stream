(function(i,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof define=="function"&&define.amd?define(t):(i=typeof globalThis<"u"?globalThis:i||self,i["ascii-byte-stream"]=t())})(this,function(){"use strict";var c=Object.defineProperty;var u=(i,t,r)=>t in i?c(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r;var o=(i,t,r)=>u(i,typeof t!="symbol"?t+"":t,r);class i{constructor(r){o(this,"BEGINNING",Symbol("beginning"));o(this,"ENDING",Symbol("ending"));o(this,"raw","");o(this,"cursor",0);this.raw=r}get current(){return this.raw[this.cursor]}get next(){return this.raw[++this.cursor]}get prev(){return this.raw[--this.cursor]}matches(r){return this.raw.slice(this.cursor,this.cursor+r.length)===r}before(r){return this.raw.slice(this.cursor-r.length,this.cursor)===r}after(r){return this.raw.slice(this.cursor+1,this.cursor+r.length+1)===r}distanceTo(r){const s=r===this.BEGINNING?this.cursor:r===this.ENDING?this.raw.length-this.cursor-1:this.raw.indexOf(r,this.cursor)-this.cursor-1;return s<0?1/0:s}closest(r){return r.map(s=>[s,this.distanceTo(s)]).sort((s,n)=>s[1]-n[1])}startTransaction(){const{cursor:r}=this;function s(){this.cursor=r}return s.bind(this)}getUntil(r){const s=this.raw.indexOf(r,this.cursor);if(s===-1)return;const n=this.raw.slice(this.cursor,s);return this.cursor+=n.length,n}slice(r){if(r<0)throw new RangeError(`Cannot slice backwards from ${this.cursor} to ${r}.`);const s=this.raw.slice(this.cursor,this.cursor+r);return this.cursor=r===1/0?this.raw.length:this.cursor+r,s}move(r){return this.cursor+=r,this}moveTo(r){return this.cursor=r,this}jumpTo(r){return this.cursor=this.raw.indexOf(r,this.cursor)}consume(r){let s;const n=this.cursor;for(Array.isArray(r)||(r=[r]);(s=r.findIndex(e=>this.matches(e)))>-1;)this.move(r[s].length);return this.raw.slice(n,this.cursor)}}return i});
